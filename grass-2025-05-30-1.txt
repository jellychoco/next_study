Fix bugs and improve performance on 2025-05-30 (commit 1)